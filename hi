SELECT ROWNUM-1 AS ROWNUM_MINUS_1, BCBSA_VBP_ID AS ID, NULL AS PRCTR_ROLE_ID, NULL AS AFFLTN_TYPE, NULL AS DISPLAY, NULL AS PROV_ENTY_ID, NULL AS TXNMY_CD, NULL AS TXNMY_DSPLY_VAL
FROM (
    SELECT DISTINCT VBP.PROV_RESOURCE_ID, VBP.BCBSA_VBP_ID
    FROM PDT.WRK_PRCTR_ROLE_LCTN_XWALK PR
    INNER JOIN PDT.WRK_PRCTR_ROLE RL ON RL.PRCTR_ROLE_ID = PR.PRCTR_ROLE_ID
    INNER JOIN PDT.PROV_VBP VBP ON RL.PROV_RESOURCE_ID = VBP.PROV_RESOURCE_ID
        AND PR.LCTN_RESOURCE_ID = VBP.LCTN_RESOURCE_ID
        AND RL.NTWK_RESOURCE_ID = VBP.NTWK_RESOURCE_ID
    INNER JOIN PDT.BCBSA_PLANCD_VBP_XWALK PLV ON VBP.BCBSA_VBP_ID = PLV.VBP_ID
        AND SUBSTR(RL.NTWK_RESOURCE_ID, 0, 3) = PLV.PLAN_CD
    WHERE PR.PRCTR_ROLE_ID = '040-778e04c576623b4a925bc483e111f36e-PractitionerRole'
        AND VBP.BCBSA_VBP_ID IS NOT NULL
) TBL1

UNION ALL

SELECT NULL AS ROWNUM_MINUS_1, NULL AS ID, PROV_MBR_SLF_ATRBTN_IND AS PRCTR_ROLE_ID, NULL AS AFFLTN_TYPE, NULL AS DISPLAY, NULL AS PROV_ENTY_ID, NULL AS TXNMY_CD, NULL AS TXNMY_DSPLY_VAL
FROM (
    SELECT DISTINCT VBP.PROV_RESOURCE_ID, VBP.PROV_MBR_SLF_ATRBTN_IND
    FROM PDT.WRK_PRCTR_ROLE_LCTN_XWALK PR
    INNER JOIN PDT.WRK_PRCTR_ROLE RL ON RL.PRCTR_ROLE_ID = PR.PRCTR_ROLE_ID
    INNER JOIN PDT.PROV_VBP VBP ON RL.PROV_RESOURCE_ID = VBP.PROV_RESOURCE_ID
        AND PR.LCTN_RESOURCE_ID = VBP.LCTN_RESOURCE_ID
        AND RL.NTWK_RESOURCE_ID = VBP.NTWK_RESOURCE_ID
    INNER JOIN PDT.BCBSA_PLANCD_VBP_XWALK PLV ON VBP.BCBSA_VBP_ID = PLV.VBP_ID
        AND SUBSTR(RL.NTWK_RESOURCE_ID, 0, 3) = PLV.PLAN_CD
    WHERE PR.PRCTR_ROLE_ID = '040-778e04c576623b4a925bc483e111f36e-PractitionerRole'
        AND VBP.PROV_MBR_SLF_ATRBTN_IND IS NOT NULL
) TBL2

UNION ALL

SELECT ROWNUM-1 AS ROWNUM_MINUS_1, NULL AS ID, PRCTR_ROLE_ID, AFFLTN_TYPE, NULL AS DISPLAY, NULL AS PROV_ENTY_ID, NULL AS TXNMY_CD, NULL AS TXNMY_DSPLY_VAL
FROM (
    SELECT DISTINCT PRCTR_ROLE_ID, AFFLTN_TYPE
    FROM PDT.WRK_PRCTR_ROLE
    WHERE WRK_PRCTR_ROLE.ORG_RESOURCE_ID IS NOT NULL 
        AND WRK_PRCTR_ROLE.PRCTR_ROLE_ID='040-778e04c576623b4a925bc483e111f36e-PractitionerRole'
) nest_tbl1

UNION ALL

SELECT ROWNUM-1 AS ROWNUM_MINUS_1, NULL AS ID, PRCTR_ROLE_ID, NULL AS AFFLTN_TYPE, DISPLAY, NULL AS PROV_ENTY_ID, NULL AS TXNMY_CD, NULL AS TXNMY_DSPLY_VAL
FROM (
    SELECT DISTINCT PRCTR_ROLE_ID, PROV_AFFLTN_RESOURCE_ID, PROV_HOSP_AFFLTN_TYPE,
           CASE WHEN PROV_HOSP_AFFLTN_TYPE = 'ADMITPRIV' THEN 'Hospital admitting privileges' ELSE 'Facility affiliation' END AS DISPLAY
    FROM PDT.WRK_PRCTR_ROLE
    WHERE PROV_AFFLTN_RESOURCE_ID IS NOT NULL
        AND PRCTR_ROLE_ID = '040-778e04c576623b4a925bc483e111f36e-PractitionerRole'
) tab1

UNION ALL

SELECT ROWNUM-1 AS ROWNUM_MINUS_1, NULL AS ID, PRCTR_ROLE_ID, NULL AS AFFLTN_TYPE, NULL AS DISPLAY, PROV_ENTY_ID, NULL AS TXNMY_CD, NULL AS TXNMY_DSPLY_VAL
FROM (
    SELECT DISTINCT PRCTR_ROLE_ID, VBP.PROV_ENTY_ID
    FROM PDT.WRK_PRCTR_ROLE_LCTN_XWALK PR
    INNER JOIN PDT.WRK_PRCTR_ROLE RL ON RL.PRCTR_ROLE_ID = PR.PRCTR_ROLE_ID
    INNER JOIN PDT.PROV_VBP VBP ON RL.PROV_RESOURCE_ID = VBP.PROV_RESOURCE_ID
        AND PR.LCTN_RESOURCE_ID = VBP.LCTN_RESOURCE_ID
        AND RL.NTWK_RESOURCE_ID = VBP.NTWK_RESOURCE_ID
    INNER JOIN PDT.BCBSA_PLANCD_VBP_XWALK PLV ON VBP.BCBSA_VBP_ID = PLV.VBP_ID
        AND SUBSTR(RL.NTWK_RESOURCE_ID, 0, 3) = PLV.PLAN_CD
    WHERE PR.PRCTR_ROLE_ID = '040-778e04c576623b4a925bc483e111f36e-PractitionerRole'
        AND VBP.PROV_ENTY_ID IS NOT NULL
    ORDER BY VBP.PROV_ENTY_ID
) TBL3

UNION ALL

SELECT ROWNUM-1 AS ROWNUM_MINUS_1, NULL AS ID, PRCTR_ROLE_ID, NULL AS AFFLTN_TYPE, NULL AS DISPLAY, NULL AS PROV_ENTY_ID, TXNMY_CD, TXNMY_DSPLY_VAL
FROM (
    SELECT DISTINCT PRCTR_ROLE_ID, TXNMY_CD, TXNMY_DSPLY_VAL
    FROM PDT.WRK_PRCTR_ROLE 
    WHERE PRCTR_ROLE_ID = '040-778e04c576623b4a925bc483e111f36e-PractitionerRole'
) nest_tbl2

UNION ALL

SELECT ROWNUM-1 AS ROWNUM_MINUS_1, NULL AS ID, NULL AS PRCTR_ROLE_ID, NULL AS AFFLTN_TYPE, NULL AS DISPLAY, NULL AS PROV_ENTY_ID, NULL AS TXNMY_CD, NULL AS TXNMY_DSPLY_VAL
FROM (
    SELECT DISTINCT LCTN_RESOURCE_ID
    FROM PDT.wrk_prctr_role_lctn_xwalk
    WHERE PRCTR_ROLE_ID = '040-778e04c576623b4a925bc483e111f36e-PractitionerRole'
) TBL4

UNION ALL

SELECT NULL AS ROWNUM_MINUS_1, intq.PROV_HLTH_SRVC_RESOURCE_ID AS ID, NULL AS PRCTR_ROLE_ID, NULL AS AFFLTN_TYPE, NULL AS DISPLAY, NULL AS PROV_ENTY_ID, NULL AS TXNMY_CD, NULL AS TXNMY_DSPLY_VAL
FROM (
    SELECT DISTINCT PH.PROV_HLTH_SRVC_RESOURCE_ID
    FROM PDT.WRK_PROV_HLTH_SRVC PH
    INNER JOIN PDT.wrk_prctr_role_lctn_xwalk PR ON PH.LCTN_RESOURCE_ID = PR.LCTN_RESOURCE_ID
                                                AND PH.PRCTR_ROLE_RESOURCE_ID = PR.PRCTR_ROLE_ID 
    WHERE PH.PRCTR_ROLE_RESOURCE_ID = '040-778e04c576623b4a925bc483e111f36e-PractitionerRole'
) intq;
//the above query is all about the joined query in excel





//below one without where clause

SELECT ROWNUM-1 AS ROWNUM_MINUS_1, BCBSA_VBP_ID AS ID, NULL AS PRCTR_ROLE_ID, NULL AS AFFLTN_TYPE, NULL AS DISPLAY, NULL AS PROV_ENTY_ID, NULL AS TXNMY_CD, NULL AS TXNMY_DSPLY_VAL
FROM (
    SELECT DISTINCT VBP.PROV_RESOURCE_ID, VBP.BCBSA_VBP_ID
    FROM PDT.WRK_PRCTR_ROLE_LCTN_XWALK PR
    INNER JOIN PDT.WRK_PRCTR_ROLE RL ON RL.PRCTR_ROLE_ID = PR.PRCTR_ROLE_ID
    INNER JOIN PDT.PROV_VBP VBP ON RL.PROV_RESOURCE_ID = VBP.PROV_RESOURCE_ID
        AND PR.LCTN_RESOURCE_ID = VBP.LCTN_RESOURCE_ID
        AND RL.NTWK_RESOURCE_ID = VBP.NTWK_RESOURCE_ID
    INNER JOIN PDT.BCBSA_PLANCD_VBP_XWALK PLV ON VBP.BCBSA_VBP_ID = PLV.VBP_ID
        AND SUBSTR(RL.NTWK_RESOURCE_ID, 0, 3) = PLV.PLAN_CD
    -- Removed WHERE clause
) TBL1

UNION ALL

SELECT NULL AS ROWNUM_MINUS_1, NULL AS ID, PROV_MBR_SLF_ATRBTN_IND AS PRCTR_ROLE_ID, NULL AS AFFLTN_TYPE, NULL AS DISPLAY, NULL AS PROV_ENTY_ID, NULL AS TXNMY_CD, NULL AS TXNMY_DSPLY_VAL
FROM (
    SELECT DISTINCT VBP.PROV_RESOURCE_ID, VBP.PROV_MBR_SLF_ATRBTN_IND
    FROM PDT.WRK_PRCTR_ROLE_LCTN_XWALK PR
    INNER JOIN PDT.WRK_PRCTR_ROLE RL ON RL.PRCTR_ROLE_ID = PR.PRCTR_ROLE_ID
    INNER JOIN PDT.PROV_VBP VBP ON RL.PROV_RESOURCE_ID = VBP.PROV_RESOURCE_ID
        AND PR.LCTN_RESOURCE_ID = VBP.LCTN_RESOURCE_ID
        AND RL.NTWK_RESOURCE_ID = VBP.NTWK_RESOURCE_ID
    INNER JOIN PDT.BCBSA_PLANCD_VBP_XWALK PLV ON VBP.BCBSA_VBP_ID = PLV.VBP_ID
        AND SUBSTR(RL.NTWK_RESOURCE_ID, 0, 3) = PLV.PLAN_CD
    -- Removed WHERE clause
) TBL2

UNION ALL

SELECT ROWNUM-1 AS ROWNUM_MINUS_1, NULL AS ID, PRCTR_ROLE_ID, AFFLTN_TYPE, NULL AS DISPLAY, NULL AS PROV_ENTY_ID, NULL AS TXNMY_CD, NULL AS TXNMY_DSPLY_VAL
FROM (
    SELECT DISTINCT PRCTR_ROLE_ID, AFFLTN_TYPE
    FROM PDT.WRK_PRCTR_ROLE
    -- Removed WHERE clause
) nest_tbl1

UNION ALL

SELECT ROWNUM-1 AS ROWNUM_MINUS_1, NULL AS ID, PRCTR_ROLE_ID, NULL AS AFFLTN_TYPE, DISPLAY, NULL AS PROV_ENTY_ID, NULL AS TXNMY_CD, NULL AS TXNMY_DSPLY_VAL
FROM (
    SELECT DISTINCT PRCTR_ROLE_ID, PROV_AFFLTN_RESOURCE_ID, PROV_HOSP_AFFLTN_TYPE,
           CASE WHEN PROV_HOSP_AFFLTN_TYPE = 'ADMITPRIV' THEN 'Hospital admitting privileges' ELSE 'Facility affiliation' END AS DISPLAY
    FROM PDT.WRK_PRCTR_ROLE
    -- Removed WHERE clause
) tab1

UNION ALL

SELECT ROWNUM-1 AS ROWNUM_MINUS_1, NULL AS ID, PRCTR_ROLE_ID, NULL AS AFFLTN_TYPE, NULL AS DISPLAY, PROV_ENTY_ID, NULL AS TXNMY_CD, NULL AS TXNMY_DSPLY_VAL
FROM (
    SELECT DISTINCT PRCTR_ROLE_ID, VBP.PROV_ENTY_ID
    FROM PDT.WRK_PRCTR_ROLE_LCTN_XWALK PR
    INNER JOIN PDT.WRK_PRCTR_ROLE RL ON RL.PRCTR_ROLE_ID = PR.PRCTR_ROLE_ID
    INNER JOIN PDT.PROV_VBP VBP ON RL.PROV_RESOURCE_ID = VBP.PROV_RESOURCE_ID
        AND PR.LCTN_RESOURCE_ID = VBP.LCTN_RESOURCE_ID
        AND RL.NTWK_RESOURCE_ID = VBP.NTWK_RESOURCE_ID
    INNER JOIN PDT.BCBSA_PLANCD_VBP_XWALK PLV ON VBP.BCBSA_VBP_ID = PLV.VBP_ID
        AND SUBSTR(RL.NTWK_RESOURCE_ID, 0, 3) = PLV.PLAN_CD
    -- Removed WHERE clause
    ORDER BY VBP.PROV_ENTY_ID
) TBL3

UNION ALL

SELECT ROWNUM-1 AS ROWNUM_MINUS_1, NULL AS ID, PRCTR_ROLE_ID, NULL AS AFFLTN_TYPE, NULL AS DISPLAY, NULL AS PROV_ENTY_ID, TXNMY_CD, TXNMY_DSPLY_VAL
FROM (
    SELECT DISTINCT PRCTR_ROLE_ID, TXNMY_CD, TXNMY_DSPLY_VAL
    FROM PDT.WRK_PRCTR_ROLE 
    -- Removed WHERE clause
) nest_tbl2

UNION ALL

SELECT ROWNUM-1 AS ROWNUM_MINUS_1, NULL AS ID, NULL AS PRCTR_ROLE_ID, NULL AS AFFLTN_TYPE, NULL AS DISPLAY, NULL AS PROV_ENTY_ID, NULL AS TXNMY_CD, NULL AS TXNMY_DSPLY_VAL
FROM (
    SELECT DISTINCT LCTN_RESOURCE_ID
    FROM PDT.wrk_prctr_role_lctn_xwalk
    -- Removed WHERE clause
) TBL4

UNION ALL

SELECT NULL AS ROWNUM_MINUS_1, intq.PROV_HLTH_SRVC_RESOURCE_ID AS ID, NULL AS PRCTR_ROLE_ID, NULL AS AFFLTN_TYPE, NULL AS DISPLAY, NULL AS PROV_ENTY_ID, NULL AS TXNMY_CD, NULL AS TXNMY_DSPLY_VAL
FROM (
    SELECT DISTINCT PH.PROV_HLTH_SRVC_RESOURCE_ID
    FROM PDT.WRK_PROV_HLTH_SRVC PH
    INNER JOIN PDT.wrk_prctr_role_lctn_xwalk PR ON PH.LCTN_RESOURCE_ID = PR.LCTN_RESOURCE_ID
                                                AND PH.PRCTR_ROLE_RESOURCE_ID = PR.PRCTR_ROLE_ID 
    -- Removed WHERE clause
) intq;
