SELECT 

    DISTINCT WR.PRCTR_ROLE_ID,

    WR.PROV_RESOURCE_ID,

    WR.PROV_TYPE_PERF_CLM,

    WR.ENTITY_TYPE,

    WR.DIR_DSPLY_IND,

    WR.PROV_PATIENT_AGE_FROM,

    WR.PROV_PATIENT_AGE_TO,

    WR.PROV_PATIENT_GNDR_RESTRCT,

    WR.PROV_PHYSN_STTS_CD,

    WR.PRCTR_TRMNTN_RSN_CD,

    WR.PROV_PCP_EFCTV_DT,

    WR.PROV_PCP_TRMNTN_DT,

    WR.PCP_IND,

    WR.PROV_CPTN_IND,

    WR.PCP_SELECTABILITY_IND,

    WR.PRCTR_ROLE_EFCTV_DT,

    WR.PRCTR_ROLE_TRMNTN_DT,

    WR.PRCTR_ROLE_LCTN_RESOURCE_ID,

    WR.LCNS_RESOURCE_ID  ,

    WR.ORG_RESOURCE_ID,

    WR.NTWK_RESOURCE_ID,

    WR.PROV_TYPE_PERF_DSPLY_VAL,

    WR.PROV_TIER_DESGNTN_IND,

    TX.TXNMY_CD,

    TX.TXNMY_DSPLY_VAL,

    AF.PROV_AFFLTN_RESOURCE_ID,

    AF.AFFLTN_TYPE,

    AF.AFFLTN_DSPLY_VAL,

    VBP.PROV_MBR_SLF_ATRBTN_IND,

    VBP.BCBSA_VBP_ID,

    VBP.PROV_ENTY_ID,

    HS.PROV_HLTH_SRVC_RESOURCE_ID,

    POF.PROV_DAY_OF_WEEK,

    POF.PROV_OFC_STRT_TM,

    POF.PROV_OFC_END_TM

FROM PDT.WRK_PRCTR_ROLE WR

LEFT JOIN (

    SELECT DISTINCT PRCTR_ROLE_ID, TXNMY_CD, TXNMY_DSPLY_VAL 

    FROM PDT.WRK_PRCTR_ROLE

) TX ON WR.PRCTR_ROLE_ID = TX.PRCTR_ROLE_ID

LEFT JOIN (

   SELECT DISTINCT WRK_PRCTR_ROLE.PRCTR_ROLE_ID, PROV_AFFLTN_RESOURCE_ID
,PROV_HOSP_AFFLTN_TYPE, 
--WRK_PRCTR_ROLE.AFFLTN_RESOURCE_ID, 
WRK_PRCTR_ROLE.AFFLTN_TYPE,
CASE WHEN WRK_PRCTR_ROLE.AFFLTN_TYPE = 'PROVGRP' THEN 'Provider Group' 
WHEN WRK_PRCTR_ROLE.AFFLTN_TYPE = 'FACILITY' THEN 'Facility' 
ELSE '' END AS AFFLTN_DSPLY_VAL,width_bucket(TO_NUMBER(MSTR_PROV_ID), 1, 70000, 5) PR_GRP

FROM PDT.WRK_PRCTR_ROLE
WHERE WRK_PRCTR_ROLE.ORG_RESOURCE_ID IS NOT NULL;

) AF ON WR.PRCTR_ROLE_ID = AF.PRCTR_ROLE_ID

LEFT JOIN (

    SELECT DISTINCT prov_resource_id, lctn_resource_id, PROV_MBR_SLF_ATRBTN_IND, BCBSA_VBP_ID, prov_enty_id

    FROM pdt.prov_vbp

) VBP ON WR.prov_resource_id = VBP.prov_resource_id AND WR.LCTN_RESOURCE_ID   = VBP.lctn_resource_id

LEFT JOIN (

    SELECT DISTINCT PRCTR_ROLE_RESOURCE_ID, PROV_HLTH_SRVC_RESOURCE_ID 

    FROM PDT.WRK_PROV_HLTH_SRVC

) HS ON WR.PRCTR_ROLE_ID = HS.PRCTR_ROLE_RESOURCE_ID

LEFT JOIN (

    SELECT DISTINCT prov_resource_id, PROV_DAY_OF_WEEK, PROV_OFC_STRT_TM, PROV_OFC_END_TM

    FROM pdt.pofc_hours

) POF ON WR.prov_resource_id = POF.prov_resource_id;
  
SELECT DISTINCT
LCTN_RESOURCE_ID
FROM PDT.wrk_prctr_role_lctn_xwalk
WHERE PRCTR_ROLE_ID = <PRCTR_ROLE_ID>



SELECT DISTINCT
    WR.PRCTR_ROLE_ID,
    WR.PROV_RESOURCE_ID,
    WR.PROV_TYPE_PERF_CLM,
    WR.ENTITY_TYPE,
    WR.DIR_DSPLY_IND,
    WR.PROV_PATIENT_AGE_FROM,
    WR.PROV_PATIENT_AGE_TO,
    WR.PROV_PATIENT_GNDR_RESTRCT,
    WR.PROV_PHYSN_STTS_CD,
    WR.PRCTR_TRMNTN_RSN_CD,
    WR.PROV_PCP_EFCTV_DT,
    WR.PROV_PCP_TRMNTN_DT,
    WR.PCP_IND,
    WR.PROV_CPTN_IND,
    WR.PCP_SELECTABILITY_IND,
    WR.PRCTR_ROLE_EFCTV_DT,
    WR.PRCTR_ROLE_TRMNTN_DT,
    WR.PRCTR_ROLE_LCTN_RESOURCE_ID,
    WR.LCNS_RESOURCE_ID,
    WR.ORG_RESOURCE_ID,
    WR.NTWK_RESOURCE_ID,
    WR.PROV_TYPE_PERF_DSPLY_VAL,
    WR.PROV_TIER_DESGNTN_IND,
    TX.TXNMY_CD,
    TX.TXNMY_DSPLY_VAL,
    AF.PROV_AFFLTN_RESOURCE_ID,
    AF.AFFLTN_TYPE,
    AF.AFFLTN_DSPLY_VAL,
    VBP.PROV_MBR_SLF_ATRBTN_IND,
    VBP.BCBSA_VBP_ID,
    VBP.PROV_ENTY_ID,
    HS.PROV_HLTH_SRVC_RESOURCE_ID,
    POF.PROV_DAY_OF_WEEK,
    POF.PROV_OFC_STRT_TM,
    POF.PROV_OFC_END_TM,
    LCTN.LCTN_RESOURCE_ID  -- Include the column from wrk_prctr_role_lctn_xwalk
FROM 
    PDT.WRK_PRCTR_ROLE WR
INNER JOIN 
    (SELECT DISTINCT PRCTR_ROLE_ID, TXNMY_CD, TXNMY_DSPLY_VAL 
     FROM PDT.WRK_PRCTR_ROLE) TX ON WR.PRCTR_ROLE_ID = TX.PRCTR_ROLE_ID
INNER JOIN 
    (SELECT DISTINCT PRCTR_ROLE_ID, PROV_AFFLTN_RESOURCE_ID, AFFLTN_TYPE, 
                     CASE 
                         WHEN AFFLTN_TYPE = 'PROVGRP' THEN 'Provider Group' 
                         WHEN AFFLTN_TYPE = 'FACILITY' THEN 'Facility' 
                         ELSE '' 
                     END AS AFFLTN_DSPLY_VAL
     FROM PDT.WRK_PRCTR_ROLE
     WHERE ORG_RESOURCE_ID IS NOT NULL) AF ON WR.PRCTR_ROLE_ID = AF.PRCTR_ROLE_ID
INNER JOIN 
    (SELECT DISTINCT prov_resource_id, lctn_resource_id, PROV_MBR_SLF_ATRBTN_IND, BCBSA_VBP_ID, prov_enty_id
     FROM pdt.prov_vbp) VBP ON WR.prov_resource_id = VBP.prov_resource_id AND WR.LCTN_RESOURCE_ID = VBP.lctn_resource_id
INNER JOIN 
    (SELECT DISTINCT PRCTR_ROLE_RESOURCE_ID, PROV_HLTH_SRVC_RESOURCE_ID 
     FROM PDT.WRK_PROV_HLTH_SRVC) HS ON WR.PRCTR_ROLE_ID = HS.PRCTR_ROLE_RESOURCE_ID
INNER JOIN 
    (SELECT DISTINCT prov_resource_id, PROV_DAY_OF_WEEK, PROV_OFC_STRT_TM, PROV_OFC_END_TM
     FROM pdt.pofc_hours) POF ON WR.prov_resource_id = POF.prov_resource_id
INNER JOIN 
    (SELECT DISTINCT LCTN_RESOURCE_ID, PRCTR_ROLE_ID
     FROM PDT.wrk_prctr_role_lctn_xwalk
     WHERE PRCTR_ROLE_ID = <PRCTR_ROLE_ID>) LCTN ON WR.PRCTR_ROLE_ID = LCTN.PRCTR_ROLE_ID;
